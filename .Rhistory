paste0(str_flatten(temp,"->"),"\n}\n")
}
for(i in 0:(width-1)){
df2=df1[df1$x1==i,]
temp=c(df2$text[df2$group1=="H1"],df2$text[!(df2$group1 %in% c("H1","H2"))],df2$text[df2$group1=="H2"])
temp=c(paste0("t",i),temp)
equation<-equation %>% addEquation(temp)
}
temp=unique(df1$group2)
temp=setdiff(temp,"")
temp
df1
if(length(temp>0)){
for(i in 1:length(temp)){
tempvar=df1$text[df1$group2==temp[i]]
if(df1$group[df1$text==temp[i]]=="Y"){
equation <- equation %>%
paste0(temp[i],"->{",str_flatten(tempvar,","),"};\n")
} else{
equation <- equation %>%
paste0("{",str_flatten(tempvar,","),"}->",temp[i],"[dir=back];\n")
}
}
}
M=df1$text[substr(df1$group1,1,1)=="M"]
Y=df1$text[df1$group1=="Y"]
MY=c(M,Y)
X=df1$text[df1$group1=="X"]
if(length(MY)>0){
equation <- equation %>%
paste0("{",str_flatten(X,","),"}->{",str_flatten(MY,","),"};\n")
}
if(length(M)*length(Y)>0){
equation <- equation %>%
paste0("{",str_flatten(M,","),"}->{",str_flatten(Y,","),"};\n")
}
if(length(M)>1){
equation <- equation %>%
paste0(str_flatten(M,"->"),";")
}
equation=paste0(equation,"\n}")
equation
}
addPos2=function(df){
df$x1=df$x
width<-width1<-width2<-length(unique(df$x))
width
evenno=0
temp=df$text[df$group1=="H1"]
temp
if(length(temp)>2){
width1=width+length(temp)-3
width1
length(temp)%%2
if(length(temp)%%2==0){
width1=width1+1
evenno=1
}
}
width1
temp=df$text[df$group1=="H2"]
if(length(temp)>2){
width2=width+length(temp)-3
if(length(temp)%%2==0){
width2=width2+1
evenno=1
}
}
width2
width=max(width1,width2)
width
max(df$x1)
diff=width-max(df$x1)-1
diff
df[df$x1>2,]
evenno
df$x1[df$x1>2]=df$x1[df$x1>2]+diff+evenno-1
df
diff+evenno
width
df$x1[df$group1 %in% c("M1","M2")]=width%/%2
temp=df$text[df$group1=="H1"]
if(length(temp)>2){
if(length(temp)%%2==0){
add=0:(length(temp)-1)
add[(length(temp)/2+1):length(temp)]=add[(length(temp)/2+1):length(temp)]+1
add
df$x1[df$group1=="H1"]=1+add
} else {
df$x1[df$group1=="H1"]=1:(1+length(temp)-1)
}
} else if(length(temp)==2){
df$x1[df$group1=="H1"]=c(1,width-2)
}
df
temp=df$text[df$group1=="H2"]
if(length(temp)>2){
if(length(temp)%%2==0){
add=0:(length(temp)-1)
add[(length(temp)/2+1):length(temp)]=add[(length(temp)/2+1):length(temp)]+1
df$x1[df$group1=="H2"]=1+add
} else{
df$x1[df$group1=="H2"]=1:(1+length(temp)-1)
}
} else if(length(temp)==2){
df$x1[df$group1=="H2"]=c(1,width-2)
}
df
}
semPaths(fit)
mediationPlot(fit)
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3
dem61 =~ y4+ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3
dem61 =~ y4+ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3+ y4
dem61 =~ y5 + y6
dem65 =~ y7 + y8
'
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3+ y4
dem61 =~ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3
dem61 =~ y4+ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3+ y4
dem61 =~ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3
dem61 =~ y4+ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
df=fit2df(fit)
df=addpos(df)
df
df1=addPos2(df)
df1
mediationPlot(fit)
df=fit2df(fit)
df=addpos(df)
df
df$x1=df$x
width<-width1<-width2<-length(unique(df$x))
width
evenno=0
temp=df$text[df$group1=="H1"]
temp
if(length(temp)>2){
width1=width+length(temp)-3
width1
length(temp)%%2
if(length(temp)%%2==0){
width1=width1+1
evenno=1
}
}
width1
temp=df$text[df$group1=="H2"]
if(length(temp)>2){
width2=width+length(temp)-3
if(length(temp)%%2==0){
width2=width2+1
evenno=1
}
}
width2
width=max(width1,width2)
width
max(df$x1)
diff=width-max(df$x1)-1
diff
df[df$x1>2,]
evenno
diff
evenno
addPos2=function(df){
df$x1=df$x
width<-width1<-width2<-length(unique(df$x))
width
evenno=0
temp=df$text[df$group1=="H1"]
temp
if(length(temp)>2){
width1=width+length(temp)-3
width1
length(temp)%%2
if(length(temp)%%2==0){
width1=width1+1
evenno=1
}
}
width1
temp=df$text[df$group1=="H2"]
if(length(temp)>2){
width2=width+length(temp)-3
if(length(temp)%%2==0){
width2=width2+1
evenno=1
}
}
width2
width=max(width1,width2)
width
max(df$x1)
diff=width-max(df$x1)-1
diff
df[df$x1>2,]
evenno
df$x1[df$x1>2]=df$x1[df$x1>2]+diff
df
diff+evenno
width
df$x1[df$group1 %in% c("M1","M2")]=width%/%2
temp=df$text[df$group1=="H1"]
if(length(temp)>2){
if(length(temp)%%2==0){
add=0:(length(temp)-1)
add[(length(temp)/2+1):length(temp)]=add[(length(temp)/2+1):length(temp)]+1
add
df$x1[df$group1=="H1"]=1+add
} else {
df$x1[df$group1=="H1"]=1:(1+length(temp)-1)
}
} else if(length(temp)==2){
df$x1[df$group1=="H1"]=c(1,width-2)
}
df
temp=df$text[df$group1=="H2"]
if(length(temp)>2){
if(length(temp)%%2==0){
add=0:(length(temp)-1)
add[(length(temp)/2+1):length(temp)]=add[(length(temp)/2+1):length(temp)]+1
df$x1[df$group1=="H2"]=1+add
} else{
df$x1[df$group1=="H2"]=1:(1+length(temp)-1)
}
} else if(length(temp)==2){
df$x1[df$group1=="H2"]=c(1,width-2)
}
df
}
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3+ y4
dem61 =~ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
cat(semDiagram(fit))
grViz(semDiagram(fit))
HS.model <- ' visual  =~ x1 + x2 + x3
textual =~ x4 + x5 + x6
speed   =~ x7 + x8 + x9 '
fit <- cfa(HS.model, data = HolzingerSwineford1939)
semPaths(fit)
mediationPlot(fit)
grViz(semDiagram(fit))
set.seed(1234)
X1 <- rnorm(100)
X2 <- c(rnorm(50),rnorm(50))
M1 <- 0.5*X1 + 0.5*X2 +rnorm(100)
M2 <-0.6*X1 +0.4*X2+rnorm(100)
Y1 <- 0.3*M1 + 0.4*M2 + rnorm(100)
Y2 <- 0.1*M1 + 0.5*M2 + rnorm(100)
data <- data.frame(X1 = X1, X2 = X2, Y1 = Y1, Y2 = Y2, M1 = M1, M2 = M2)
model=
"X=~X1+X2
"
model1=makeEquation(X="X",M=c("M1","M2"),Y="Y1")
model=paste0(model,model1)
fit=sem(model,data=data)
semPaths(fit,rotation=2,whatLabels = "std")
semPaths(fit,rotation=2,whatLabels = "std")
mediationPlot(fit)
grViz(semDiagram(fit))
mediationPlot(fit)
grViz(semDiagram(fit))
model=makeEquation(X=c("X1","X2"),M=c("M1","M2"),Y="Y1")
cat(model)
fit=sem(model,data=data)
semPaths(fit)
mediationPlot(fit)
grViz(semDiagram(fit))
mediationPlot(fit)
grViz(semDiagram(fit))
model=makeEquation(X=c("X1","X2"),M="M1",Y="Y1")
cat(model)
fit=sem(model,data=data)
semPaths(fit)
mediationPlot(fit)
grViz(semDiagram(fit))
model=makeEquation(X=c("X1","X2"),M=c("M1","M2"),Y=c("Y1","Y2"))
cat(model)
fit=sem(model,data=data)
semPaths(fit)
mediationPlot(fit)
grViz(semDiagram(fit))
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3+ y4
dem61 =~ y5 + y6
dem65 =~ y7 + y8
'
model <- '
# latent variables
ind60 =~ x1 + x2 + x3
dem60 =~ y1 + y2 + y3
dem61 =~ y4+ y5 + y6
dem65 =~ y7 + y8
'
model1=makeEquation(X="ind60",M=c("dem60","dem61"),Y="dem65")
model1
model=paste0(model,model1)
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit)
mediationPlot(fit)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
?? `%.%`
?? `%>%`
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
DiagrammeR::grViz("Untitled.gv")
DiagrammeR::grViz("Untitled.gv")
DiagrammeR::grViz("Untitled.gv")
DiagrammeR::grViz("Untitled.gv")
DiagrammeR::grViz("~/ownCloud/Documents/DiagrammeRTest/XMY.gv")
devtools::document()
devtools::check()
require(lavaan)
require(semPlot)
require(semMediation)
require(DiagrammeR)
model <- '
# latent variables
X1 =~ x1 + x2
X2 =~ x3
X3 =~ x4
M1 =~ y1 + y2 +y3
M2 =~  y4 + y5
Y1 =~  y6
Y2 =~ y7 +y 8
'
model1=makeEquation(X=c("X1","X2","X3"),M=c("M1","M2"),Y=c("Y1","Y2"))
model=paste0(model,model1)
cat(model)
str(PoliticalDemocracy)
PoliticalDemocracy$x4=PoliticalDemocracy$x1+PoliticalDemocracy$x2
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit,rotation=2,whatLabels = "std",groups="manlat",pastel=TRUE)
mediationPlot(fit,whatLabels = "name")
semDiagram(fit)
require(stringr)
semDiagram(fit)
semDiagram(fit)
model <- '
# latent variables
X1 =~ x1 + x2
X2 =~ x3
X3 =~ x4
M1 =~ y1 + y2 +y3
M2 =~  y4 + y5
Y1 =~  y6
Y2 =~ y7 +y 8
'
model1=makeEquation(X=c("X1","X2","X3"),M=c("M1","M2"),Y=c("Y1","Y2"))
model=paste0(model,model1)
cat(model)
str(PoliticalDemocracy)
PoliticalDemocracy$x4=PoliticalDemocracy$x1+PoliticalDemocracy$x2
fit <- sem(model,
data=PoliticalDemocracy)
semPaths(fit,rotation=2,whatLabels = "std",groups="manlat",pastel=TRUE)
mediationPlot(fit,whatLabels = "name")
semDiagram(fit)
makeDiagram(fit)
cat(makeDiagram(fit))
mediationPlot(fit,whatLabels = "name")
semDiagram(fit)
mediationPlot(fit,whatLabels = "name")
semDiagram(fit)
res=parameterEstimates(fit,standardized=TRUE)
res
res
res=parameterEstimates(fit,standardized=TRUE)
res
